{"version":3,"file":"index.js","sources":["../../node_modules/is-it-type/dist/esm/is-it-type.js","../../node_modules/tiny-invariant/dist/tiny-invariant.esm.js","../../node_modules/react-async-ssr/lib/symbols.js","../../node_modules/react-async-ssr/symbols.js","../../node_modules/is-promise/index.js","../../src/shared/constants.js","../../src/client/resource.js","../../src/shared/serverContext.js","../../src/shared/shared.js","../../src/client/createResourceFactory.js","../../node_modules/is-class-component/dist/esm/is-class-component.js","../../node_modules/is-class-component/es/index.js","../../src/client/isResource.js","../../src/client/withResources.js","../../src/client/preloadData.js"],"sourcesContent":["/* --------------------\n * is-it-type module\n * Entry point\n * ------------------*/\n// Exports\n\n/*\n * Replication of core-util-is methods.\n * https://www.npmjs.com/package/core-util-is\n */\nfunction isArray(arg) {\n  return Array.isArray(arg);\n}\nfunction isBoolean(arg) {\n  return isType('boolean', arg);\n}\nfunction isNull(arg) {\n  return arg === null;\n}\nfunction isUndefined(arg) {\n  return arg === void 0; // eslint-disable-line no-void\n}\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nfunction isNumber(arg) {\n  return isType('number', arg);\n}\nfunction isString(arg) {\n  return isType('string', arg);\n}\nfunction isSymbol(arg) {\n  return isType('symbol', arg);\n}\nfunction isRegExp(arg) {\n  return isTypeByToString('RegExp', arg);\n}\nfunction isObject(arg) {\n  return isType('object', arg) && !isNull(arg);\n}\nfunction isDate(arg) {\n  return isTypeByToString('Date', arg);\n}\nfunction isError(arg) {\n  return isTypeByToString('Error', arg) || arg instanceof Error;\n}\nfunction isFunction(arg) {\n  return isType('function', arg);\n}\nfunction isPrimitive(arg) {\n  var type = getType(arg);\n  return arg == null || type === 'boolean' || type === 'number' || type === 'string' || type === 'symbol';\n}\n/*\n * Additional methods\n */\n// Strings\n\nfunction isEmptyString(arg) {\n  return arg === '';\n}\nfunction isFullString(arg) {\n  return isString(arg) && !isEmptyString(arg);\n} // Objects\n\nfunction isEmptyObject(arg) {\n  return isObject(arg) && Object.keys(arg).length === 0;\n} // Numbers\n\nfunction isInteger(arg) {\n  return Number.isInteger(arg);\n}\nfunction isPositiveInteger(arg) {\n  return isInteger(arg) && arg > 0;\n}\nfunction isPositiveIntegerOrZero(arg) {\n  return isInteger(arg) && arg >= 0;\n}\nfunction isNegativeInteger(arg) {\n  return isInteger(arg) && arg < 0;\n}\nfunction isNegativeIntegerOrZero(arg) {\n  return isInteger(arg) && arg <= 0;\n} // Other\n\nfunction isType(type, arg) {\n  return getType(arg) === type;\n}\n/*\n * Helpers\n */\n\nfunction getType(arg) {\n  return typeof arg;\n}\n\nvar toString = Object.prototype.toString;\n\nfunction isTypeByToString(type, arg) {\n  return toString.call(arg) === \"[object \" + type + \"]\";\n}\n\nexport { isArray, isBoolean, isDate, isEmptyObject, isEmptyString, isError, isFullString, isFunction, isInteger, isNegativeInteger, isNegativeIntegerOrZero, isNull, isNullOrUndefined, isNumber, isObject, isPositiveInteger, isPositiveIntegerOrZero, isPrimitive, isRegExp, isString, isSymbol, isType, isUndefined };\n//# sourceMappingURL=is-it-type.js.map\n","var isProduction = process.env.NODE_ENV === 'production';\nvar prefix = 'Invariant failed';\nfunction invariant(condition, message) {\n    if (condition) {\n        return;\n    }\n    if (isProduction) {\n        throw new Error(prefix);\n    }\n    throw new Error(prefix + \": \" + (message || ''));\n}\n\nexport default invariant;\n","/* --------------------\n * react-async-ssr module\n * Symbols\n * ------------------*/\n\n'use strict';\n\n// Exports\n\nmodule.exports = {\n\tNO_SSR: '$_react-async-ssr/symbols.NO_SSR',\n\tABORT: '$_react-async-ssr/symbols.ABORT',\n\tON_MOUNT: '$_react-async-ssr/symbols.ON_MOUNT'\n};\n","/* --------------------\n * react-async-ssr module\n * Symbols\n * ------------------*/\n\n'use strict';\n\n// Exports\n\nmodule.exports = require('./lib/symbols.js');\n","module.exports = isPromise;\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n}\n","/* --------------------\n * react-lazy-data module\n * Constants\n * ------------------*/\n\n// Exports\n\nexport const IS_RESOURCE = '__react-lazy-data.IS_RESOURCE';\nexport const DEFAULT_CACHE_VAR = '__react-lazy-data.DATA_CACHE';\n","/* --------------------\n * react-lazy-data module\n * Resource class\n * ------------------*/\n\n// Modules\nimport {NO_SSR, ABORT, ON_MOUNT} from 'react-async-ssr/symbols';\nimport isPromise from 'is-promise';\nimport {isFunction} from 'is-it-type';\nimport invariant from 'tiny-invariant';\n\n// Imports\nimport {IS_RESOURCE} from '../shared/constants.js';\n\n// Constants\n// Load status\nconst INACTIVE = 0,\n\tLOADING = 1,\n\tLOADED = 2,\n\tERRORED = 3,\n\tABORTED = 4;\n\n// Read status\nconst NONE_CALLED = 0,\n\tREAD_CALLED = 1,\n\tCHILD_CALLED = 2;\n\n// Valid prop types\nconst PROP_TYPES = ['string', 'number', 'symbol'];\n\n// Exports\n\nexport default class Resource {\n\tconstructor(factory, req, cacheKey, context, parent) {\n\t\tthis._factory = factory;\n\t\tthis._req = req;\n\t\tthis._cacheKey = cacheKey;\n\t\tthis._context = context;\n\t\tthis._parent = parent;\n\n\t\tthis._status = parent ? LOADING : INACTIVE;\n\t\tthis._readStatus = NONE_CALLED;\n\t\tthis._isDisposed = false;\n\t\tthis._abort = undefined;\n\t\tthis._children = [];\n\t\tthis._numUndisposedChildren = 0;\n\n\t\t// Create promise\n\t\t// Could make this a thenable which calls `.then()` callbacks synchronously\n\t\t// when `this._resolve()` called, to avoid an extra tick,\n\t\t// but I don't think it's worth the code bloat to save a microtick.\n\t\tconst promise = new Promise((resolve) => {\n\t\t\tthis._resolve = resolve;\n\t\t});\n\n\t\tpromise[ABORT] = this.dispose.bind(this);\n\t\tpromise[ON_MOUNT] = this._mounted.bind(this);\n\t\tif (factory._noSsr) promise[NO_SSR] = true;\n\n\t\tthis._value = promise;\n\t}\n\n\t_load() {\n\t\t// Pass to parent if exists\n\t\tconst parent = this._parent;\n\t\tif (parent) {\n\t\t\tparent._load();\n\t\t\treturn;\n\t\t}\n\n\t\t// Do not load if already loading or aborted\n\t\tif (this._status !== INACTIVE) return;\n\n\t\t// Execute fetch function\n\t\t// TODO Catch synchronously thrown errors in `fetchFn()`\n\t\tconst fetchFn = this._factory._fetchFn;\n\t\tconst promise = fetchFn(this._req);\n\t\tinvariant(isPromise(promise), `Fetch function must return a promise - got ${promise}`);\n\n\t\t// Set loading status\n\t\tthis._status = LOADING;\n\n\t\t// Record promise's abort handler if defined\n\t\tconst {abort} = promise;\n\t\tif (isFunction(abort)) this._abort = abort.bind(promise);\n\n\t\t// Update status when promise resolves\n\t\tpromise.then(\n\t\t\tres => this._resolved(res),\n\t\t\terr => this._rejected(err)\n\t\t);\n\t}\n\n\t_resolved(value) {\n\t\tif (this._status !== LOADING) return;\n\n\t\tthis._resolvedThis(value);\n\n\t\tfor (const {child, prop} of this._children) {\n\t\t\tthis._resolveChild(child, prop);\n\t\t}\n\t}\n\n\t_resolvedThis(value) {\n\t\tthis._status = LOADED;\n\t\tthis._value = value;\n\t\tthis._abort = undefined;\n\t\tthis._resolve();\n\t}\n\n\t_resolveChild(child, prop) {\n\t\tlet value = this._value;\n\n\t\tif (prop !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = value[prop];\n\t\t\t} catch (err) {\n\t\t\t\tchild._rejected(err);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tchild._resolved(value);\n\t}\n\n\t_rejected(err) {\n\t\tif (this._status !== LOADING) return;\n\n\t\tthis._status = ERRORED;\n\t\tthis._value = err;\n\t\tthis._abort = undefined;\n\t\tthis._resolve();\n\n\t\tfor (const {child} of this._children) {\n\t\t\tchild._rejected(err);\n\t\t}\n\t}\n\n\tread() {\n\t\tthis._validateReadStatus(READ_CALLED);\n\n\t\tif (this._status === LOADED) return this._value;\n\t\tthrow this._value;\n\t}\n\n\tdispose() {\n\t\tif (this._isDisposed) return;\n\t\tthis._isDisposed = true;\n\n\t\tconst parent = this._parent;\n\t\tif (parent) {\n\t\t\tparent._disposeFromChild();\n\t\t} else {\n\t\t\tif ([INACTIVE, LOADING].includes(this._status)) {\n\t\t\t\tthis._status = ABORTED;\n\n\t\t\t\tconst abort = this._abort;\n\t\t\t\tif (abort) {\n\t\t\t\t\tthis._abort = undefined;\n\t\t\t\t\tabort();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst cacheKey = this._cacheKey;\n\t\t\tif (cacheKey !== undefined) this._factory._clearCacheEntry(cacheKey);\n\t\t}\n\t}\n\n\tchild(prop) {\n\t\tinvariant(\n\t\t\tPROP_TYPES.includes(typeof prop),\n\t\t\t`.child() must be passed a string, number or symbol - received ${prop}`\n\t\t);\n\n\t\treturn this._child(prop);\n\t}\n\n\tclone() {\n\t\treturn this._child();\n\t}\n\n\t_child(prop) {\n\t\treturn this._childWithContext(prop, this._context);\n\t}\n\n\t_childWithContext(prop, context) {\n\t\tthis._validateReadStatus(CHILD_CALLED);\n\n\t\tconst child = new Resource(this._factory, this._req, this._cacheKey, context, this);\n\n\t\tconst status = this._status;\n\t\tif (status === LOADED) {\n\t\t\tthis._resolveChild(child, prop);\n\t\t} else if (status === ERRORED) {\n\t\t\tchild._rejected(this._value);\n\t\t}\n\n\t\tthis._children.push({child, prop});\n\t\tthis._numUndisposedChildren++;\n\t\treturn child;\n\t}\n\n\t_disposeFromChild() {\n\t\tthis._numUndisposedChildren--;\n\t\tif (this._numUndisposedChildren === 0) this.dispose();\n\t}\n\n\t_validateReadStatus(newReadStatus) {\n\t\tconst readStatus = this._readStatus;\n\t\tif (readStatus === NONE_CALLED) {\n\t\t\tthis._readStatus = newReadStatus;\n\t\t} else if (readStatus !== newReadStatus) {\n\t\t\tinvariant(false, 'Cannot call both .read() and .child() / .clone() on a resource');\n\t\t}\n\t}\n\n\t_mounted(willRender) {\n\t\tconst context = this._context;\n\t\tif (context) context.register(this, willRender);\n\t}\n\n\tget isLoading() {\n\t\treturn [INACTIVE, LOADING, ABORTED].includes(this._status);\n\t}\n\n\tget isLoaded() {\n\t\treturn this._status === LOADED;\n\t}\n\n\tget isErrored() {\n\t\treturn this._status === ERRORED;\n\t}\n}\n\nResource.prototype[IS_RESOURCE] = true;\n","/* --------------------\n * react-lazy-data module\n * Server context\n * ------------------*/\n\n// Modules\nimport {createContext} from 'react';\n\n// Exports\n\nexport default createContext();\n","/* --------------------\n * react-lazy-data module\n * Shared functions\n * ------------------*/\n\n// Modules\nimport {isObject, isFullString} from 'is-it-type';\nimport invariant from 'tiny-invariant';\n\n// Imports\nimport {DEFAULT_CACHE_VAR} from './constants.js';\n\n// Constants\nconst EMPTY_OBJECT = {};\n\n// Exports\n\nexport function getCacheVarFromOptionsWithValidate(options, defaultValue) {\n\tif (options == null) {\n\t\toptions = EMPTY_OBJECT;\n\t} else {\n\t\tvalidateOptions(options);\n\t}\n\n\treturn getCacheVarFromOptions(options, defaultValue);\n}\n\nexport function validateOptions(options) {\n\tinvariant(isObject(options), `options must be an object if provided - got ${options}`);\n}\n\nexport function getCacheVarFromOptions(options, defaultValue) {\n\tconst {cacheVar} = options;\n\tif (cacheVar == null) return defaultValue || DEFAULT_CACHE_VAR;\n\n\tinvariant(\n\t\tisFullString(cacheVar),\n\t\t`options.cacheVar must be a non-empty string if provided - got ${cacheVar}`\n\t);\n\n\treturn cacheVar;\n}\n","/* --------------------\n * react-lazy-data module\n * `createResourceFactory()` function\n * ------------------*/\n\n// Modules\nimport {useRef, useEffect, useContext} from 'react';\nimport {isFunction, isString, isFullString, isBoolean} from 'is-it-type';\nimport invariant from 'tiny-invariant';\n\n// Imports\nimport Resource from './resource.js';\nimport ServerContext from '../shared/serverContext.js';\nimport {validateOptions, getCacheVarFromOptions} from '../shared/shared.js';\n\n// Constants\nconst IS_NODE = typeof window === 'undefined';\n\n// Exports\n\nclass ResourceFactory {\n\tconstructor(fetchFn, options) {\n\t\tthis._fetchFn = fetchFn;\n\n\t\t// Validate and conform options\n\t\tlet id, serialize, noSsr, cacheVar;\n\t\tif (options != null) {\n\t\t\tvalidateOptions(options);\n\n\t\t\t({id, serialize, noSsr} = options);\n\n\t\t\t// Validate and conform `id` option\n\t\t\tif (id == null) {\n\t\t\t\tid = undefined;\n\t\t\t} else {\n\t\t\t\tinvariant(\n\t\t\t\t\tisFullString(id),\n\t\t\t\t\t`options.id must be a non-empty string if provided - got ${id}`\n\t\t\t\t);\n\n\t\t\t\t// Using global cache implies serialization\n\t\t\t\tif (serialize == null) {\n\t\t\t\t\tserialize = true;\n\t\t\t\t} else {\n\t\t\t\t\tinvariant(\n\t\t\t\t\t\tserialize !== false,\n\t\t\t\t\t\t'serialization cannot be disabled when using global cache'\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Get cache var from options (use default cache var if not provided)\n\t\t\t\tcacheVar = getCacheVarFromOptions(options);\n\t\t\t}\n\n\t\t\t// Validate and conform `serialize` option\n\t\t\tif (serialize == null || serialize === false) {\n\t\t\t\tserialize = undefined;\n\t\t\t} else if (serialize === true) {\n\t\t\t\tserialize = JSON.stringify;\n\t\t\t} else {\n\t\t\t\tinvariant(\n\t\t\t\t\tisFunction(serialize),\n\t\t\t\t\t`options.serialize must be a function or boolean if provided - got ${serialize}`\n\t\t\t\t);\n\t\t\t\tserialize = wrapSerializer(serialize);\n\t\t\t}\n\n\t\t\tinvariant(\n\t\t\t\t!IS_NODE || !serialize || id,\n\t\t\t\t'If using caching on server side, must also provide options.id'\n\t\t\t);\n\n\t\t\t// Validate and conform `noSsr` option\n\t\t\tif (noSsr == null) {\n\t\t\t\tnoSsr = false;\n\t\t\t} else {\n\t\t\t\tinvariant(\n\t\t\t\t\tisBoolean(noSsr),\n\t\t\t\t\t`options.noSsr must be a boolean if provided - got ${noSsr}`\n\t\t\t\t);\n\n\t\t\t\t// No-SSR mode is only enabled on server side\n\t\t\t\tif (!IS_NODE) noSsr = false;\n\t\t\t}\n\t\t} else {\n\t\t\tnoSsr = false;\n\t\t}\n\n\t\tthis._id = id;\n\t\tthis._serialize = serialize;\n\t\tthis._noSsr = noSsr;\n\t\tthis._cacheVar = cacheVar;\n\n\t\t// Init cache\n\t\t// Cache cannot be stored on factory in SSR as the factory is static across different\n\t\t// renders, so data would cross between renders. So it is stored in context instead\n\t\t// when rendering on server side.\n\t\tif (IS_NODE) {\n\t\t\tthis._cache = undefined;\n\t\t\tthis._needContext = !!serialize;\n\t\t} else {\n\t\t\tthis._cache = serialize ? {} : undefined;\n\t\t\tthis._needContext = false;\n\t\t}\n\t}\n\n\tcreate(req) {\n\t\tinvariant(!this._needContext, '`.create` cannot be used on server side with caching enabled');\n\t\treturn this._create(req);\n\t}\n\n\t_create(req, context) {\n\t\tconst resource = this._getResource(req, undefined, context);\n\n\t\t// Load resource immediately\n\t\t// (unless in no-SSR mode, in which case leave it pending forever)\n\t\tif (!this._noSsr) resource._load();\n\n\t\treturn resource;\n\t}\n\n\tuse(req) {\n\t\t// If server-side render, load immediately with context\n\t\tif (IS_NODE) {\n\t\t\tconst context = useContext(ServerContext);\n\t\t\tinvariant(\n\t\t\t\tcontext || !this._needContext,\n\t\t\t\t'Application must be wrapped in a `DataExtractorManager` when using caching on server side'\n\t\t\t);\n\t\t\treturn this._create(req, context);\n\t\t}\n\n\t\t// If no existing resource or req has changed, create one\n\t\tconst resourceRef = useRef();\n\n\t\tlet resource = resourceRef.current;\n\t\tif (!resource || req !== resource._req) {\n\t\t\t// TODO Add `if (resource) resource.dispose();` here to abort faster?\n\t\t\tresource = this._getResource(req, resource);\n\t\t\tresourceRef.current = resource;\n\t\t}\n\n\t\t// On mount, load data\n\t\tuseEffect(() => {\n\t\t\tresource._load();\n\n\t\t\t// On unmount, dispose resource\n\t\t\treturn () => resource.dispose();\n\t\t}, [resource]);\n\n\t\t// Return resource\n\t\treturn resource;\n\t}\n\n\t_getResource(req, previousResource, context) {\n\t\t// If no cache, create new resource without caching\n\t\tconst serialize = this._serialize;\n\t\tif (!serialize) return new Resource(this, req, undefined, context);\n\n\t\t// Serialize request\n\t\tconst cacheKey = serialize(req);\n\n\t\t// If serialized request has not changed, return previous resource\n\t\tif (previousResource && previousResource._cacheKey === cacheKey) return previousResource;\n\n\t\t// Get existing resource from cache\n\t\t// Cache is either in factory or (on server side) in context\n\t\tconst cache = context ? context.getCache(this) : this._cache;\n\t\tlet masterResource = cache[cacheKey];\n\n\t\t// If not found in cache, create resource and add to cache\n\t\tif (!masterResource) {\n\t\t\t// Create new resource\n\t\t\tmasterResource = new Resource(this, req, cacheKey);\n\n\t\t\t// Get data from global cache\n\t\t\tthis._populateFromGlobalCache(masterResource, cacheKey);\n\n\t\t\t// Save resource to local cache\n\t\t\tcache[cacheKey] = masterResource;\n\t\t}\n\n\t\t// Return clone of master resource\n\t\treturn masterResource._childWithContext(undefined, context);\n\t}\n\n\t_clearCacheEntry(cacheKey) {\n\t\tif (this._cache) delete this._cache[cacheKey];\n\t}\n\n\t/**\n\t * Get data from global cache and resolve resource with it.\n\t *\n\t * The global cache is one shot - values are consumed from it, and then removed from\n\t * the cache. So next time the same request is made, it will async fetch fresh data.\n\t * Global cache is intended for SSR hyration. At the end of hydration, the cache should\n\t * be empty.\n\t *\n\t * @param {Object} resource - Resource to populate with data if found in cache\n\t * @param {string} cacheKey - Request cache key\n\t * @returns {undefined}\n\t */\n\t_populateFromGlobalCache(resource, cacheKey) {\n\t\t// Global cache only works on client-side\n\t\tif (IS_NODE) return;\n\n\t\t// If no factory ID, does not use global cache\n\t\tconst id = this._id;\n\t\tif (!id) return;\n\n\t\t// Get global cache\n\t\tconst globalCacheContainer = window[this._cacheVar];\n\t\tif (!globalCacheContainer) return;\n\t\tconst globalCache = globalCacheContainer.data;\n\t\tif (!globalCache) return;\n\n\t\t// Get data cache for this factory\n\t\tconst valuesCache = globalCache[id];\n\t\tif (!valuesCache) return;\n\n\t\t// Get data cached for this request\n\t\t// NB `.hasOwnProperty()` is safe here as we know the cache object is a plain JS object\n\t\tif (!valuesCache.hasOwnProperty(cacheKey)) return; // eslint-disable-line no-prototype-builtins\n\t\tconst value = valuesCache[cacheKey];\n\n\t\t// Delete from global cache\n\t\tdelete valuesCache[cacheKey];\n\t\tif (Object.keys(valuesCache).length === 0) delete globalCache[id];\n\n\t\t// Resolve resource with cached data\n\t\tresource._resolvedThis(value);\n\t}\n}\n\nexport default function createResourceFactory(fetchFn, options) {\n\treturn new ResourceFactory(fetchFn, options);\n}\n\n/*\n * Helper functions\n */\nfunction wrapSerializer(serialize) {\n\treturn (req) => {\n\t\tconst cacheKey = serialize(req);\n\t\tinvariant(isString(cacheKey), `serialize() must return a string - got ${cacheKey}`);\n\t\treturn cacheKey;\n\t};\n}\n","import { isFunction } from 'is-it-type';\n\n/* --------------------\n * is-class-component module\n * Entry point\n * ------------------*/\n\n/**\n * Determine if input is a React class component.\n * Input must have already been checked that it's a function before calling this.\n * @param {Function} Component - Function\n * @return {boolean} - true if is a React class component\n */\n\nfunction isClassComponent(input) {\n  return isFunction(input) && !!(input.prototype && input.prototype.isReactComponent);\n}\n\nexport default isClassComponent;\n//# sourceMappingURL=is-class-component.js.map\n","/* --------------------\n * is-class-component module\n * ESM Entry point\n * ------------------*/\n\n// Imports\nimport isClassComponent from '../dist/esm/is-class-component.js';\n\n// Exports\n\nexport default isClassComponent;\n","/* --------------------\n * react-lazy-data module\n * `isResource()` function\n * ------------------*/\n\n// Modules\nimport {isFunction} from 'is-it-type';\n\n// Imports\nimport {IS_RESOURCE} from '../shared/constants.js';\n\n// Exports\n\nexport default function isResource(value) {\n\treturn value != null && !!value[IS_RESOURCE] && isFunction(value.read);\n}\n","/* --------------------\n * react-lazy-data module\n * `withResources()` function\n * ------------------*/\n\n// Modules\nimport {createElement} from 'react';\nimport {isFunction} from 'is-it-type';\nimport isClassComponent from 'is-class-component';\nimport invariant from 'tiny-invariant';\n\n// Imports\nimport isResource from './isResource.js';\n\n// Exports\n\nexport default function withResources(Component) {\n\tinvariant(\n\t\tisFunction(Component),\n\t\t`withResources() must be passed a React component - got ${Component}`\n\t);\n\n\tconst ComponentWithResources = isClassComponent(Component)\n\t\t? wrapClassComponent(Component)\n\t\t: wrapFunctionComponent(Component);\n\n\tObject.assign(ComponentWithResources, Component);\n\tComponentWithResources.displayName = `withResources(${Component.displayName || Component.name || ''})`;\n\treturn ComponentWithResources;\n}\n\nfunction wrapFunctionComponent(Component) {\n\treturn function(props, ...otherArgs) {\n\t\tprops = processProps(props);\n\t\treturn Component.call(this, props, ...otherArgs); // eslint-disable-line no-invalid-this\n\t};\n}\n\nfunction wrapClassComponent(Component) {\n\treturn (props) => {\n\t\tprops = processProps(props);\n\t\treturn createElement(Component, props);\n\t};\n}\n\nfunction processProps(props) {\n\tprops = {...props};\n\n\tfor (const key in props) {\n\t\tconst value = props[key];\n\t\tif (isResource(value)) props[key] = value.read();\n\t}\n\n\treturn props;\n}\n","/* --------------------\n * react-lazy-data module\n * `preloadData()` function\n * ------------------*/\n\n// Imports\nimport {getCacheVarFromOptionsWithValidate} from '../shared/shared.js';\n\n// Exports\n\nexport default function preloadData(options) {\n\treturn new Promise((resolve) => {\n\t\t// Get cache var from options\n\t\t// NB This is inside promise so function never synchronously throws\n\t\tconst cacheVar = getCacheVarFromOptionsWithValidate(options);\n\n\t\tlet cacheContainer = window[cacheVar];\n\n\t\t// If data already present, resolve\n\t\tif (cacheContainer) {\n\t\t\tresolve(cacheContainer.data);\n\t\t\treturn;\n\t\t}\n\n\t\t// Set up trap to catch when data is written.\n\t\t// When it is, resolve promise.\n\t\tcacheContainer = Object.create(null, {\n\t\t\tdata: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tset(data) {\n\t\t\t\t\tObject.defineProperty(cacheContainer, 'data', {value: data});\n\t\t\t\t\tresolve(data);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\twindow[cacheVar] = cacheContainer;\n\t});\n}\n"],"names":["require$$0","IS_RESOURCE","DEFAULT_CACHE_VAR","INACTIVE","LOADING","LOADED","ERRORED","ABORTED","NONE_CALLED","READ_CALLED","CHILD_CALLED","PROP_TYPES","Resource","factory","req","cacheKey","context","parent","_factory","_req","_cacheKey","_context","_parent","_status","_readStatus","_isDisposed","_abort","undefined","_children","_numUndisposedChildren","promise","Promise","resolve","_resolve","ABORT","dispose","bind","ON_MOUNT","_mounted","_noSsr","NO_SSR","_value","_load","fetchFn","_fetchFn","isPromise","invariant","abort","isFunction","then","res","_resolved","err","_rejected","value","_resolvedThis","child","prop","_resolveChild","read","_validateReadStatus","_disposeFromChild","includes","_clearCacheEntry","_child","clone","_childWithContext","status","push","newReadStatus","readStatus","willRender","register","prototype","createContext","EMPTY_OBJECT","getCacheVarFromOptionsWithValidate","options","defaultValue","validateOptions","getCacheVarFromOptions","isObject","cacheVar","isFullString","IS_NODE","window","ResourceFactory","id","serialize","noSsr","JSON","stringify","wrapSerializer","isBoolean","_id","_serialize","_cacheVar","_cache","_needContext","create","_create","resource","_getResource","use","useContext","ServerContext","resourceRef","useRef","current","useEffect","previousResource","cache","getCache","masterResource","_populateFromGlobalCache","globalCacheContainer","globalCache","data","valuesCache","hasOwnProperty","Object","keys","length","createResourceFactory","isString","isResource","withResources","Component","ComponentWithResources","isClassComponent","wrapClassComponent","wrapFunctionComponent","assign","displayName","name","props","processProps","otherArgs","call","createElement","key","preloadData","cacheContainer","configurable","set","defineProperty"],"mappings":"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"}