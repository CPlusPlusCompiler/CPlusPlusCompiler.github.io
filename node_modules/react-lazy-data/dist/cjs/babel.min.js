"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("is-it-type"),r=e(require("tiny-invariant")),i=require("./constants.min.js"),n=e(require("babel-unique-id")),o=require("lodash");const a=r;function s(e,t,r,i){!function(e,t,r,i){const n=i.objectProperty(i.identifier(t),r);e.pushContainer("properties",n)}(e,t,i.stringLiteral(r),i)}module.exports=function(e,r){let{cacheVar:u}=r;void 0===u||t.isFullString(u)||a(!1),u===i.DEFAULT_CACHE_VAR&&(u=void 0);const c=o.pick(r,["rootPath","isPackage","packageName","packageVersion","idLength"]);return{visitor:{CallExpression(t,r){!function(e,t,r,o,u){if(!e.get("callee").isIdentifier({name:"createResourceFactory"}))return;let c,l;if(e.node.arguments.length>1){c=e.get("arguments.1");const t=function(e){e.isObjectExpression()||a(!1);const t={};for(let r=0;r<e.node.properties.length;r++){const i=e.get(`properties.${r}`),n=i.get("key");n.isIdentifier()||a(!1);const o=i.get("value"),{value:s}=o.node;t[n.node.name]={propPath:i,valuePath:o,value:s}}return t}(c),{id:r,serialize:n,noSsr:o}=t;let s=t.cacheVar,u=!0,p=!1;if(r&&!r.valuePath.isStringLiteral()&&a(!1),o&&(o.valuePath.isBooleanLiteral()||a(!1),p=o.value,p||o.propPath.remove()),n){const{valuePath:e}=n;e.isBooleanLiteral()?(u=n.value,u&&!p&&n.propPath.remove()):e.isFunctionExpression()||e.isArrowFunctionExpression()||a(!1)}if(s&&(s.valuePath.isStringLiteral()||a(!1),l=s.value,""===l&&a(!1),l===i.DEFAULT_CACHE_VAR&&(s.propPath.remove(),s=void 0)),!u||p)return r&&r.propPath.remove(),void(s&&s.propPath.remove());if(r)return}else{const t=u.objectExpression([]);e.pushContainer("arguments",t),c=e.get("arguments.1")}const p=n(t,r);s(c,"id",p,u),l||(l=o,l&&s(c,"cacheVar",l,u))}(t,r,c,u,e.types)}}}};
//# sourceMappingURL=babel.min.js.map
